{"version":3,"sources":["../node_modules/url-join/lib/url-join.js","../src/Util.ts","../src/CanvasRenderer.ts","../src/Disposable.ts","../src/Logger.ts","../src/TimestampProvider.ts","../src/StreamRecorder.ts","../src/StreamSegmenter.ts","../src/WebRecorderWorkflow0.ts","../node_modules/rrweb/es/rrweb.js","../src/RRWebRecorder.ts","../src/WebRecorderWorkflow1.ts","../src/index.ts"],"names":["NodeType","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","_id","genId","resetId","getCssRulesString","rules","cssRules","Array","from","reduce","prev","cur","cssText","error","extractOrigin","url","origin","indexOf","split","slice","join","URL_IN_CSS_REF","RELATIVE_PATH","DATA_URI","absoluteToStylesheet","href","replace","path1","path2","path3","filePath","test","stack","parts","pop","_i","parts_1","part","push","absoluteToDoc","doc","attributeValue","a","createElement","isSVGElement","el","tagName","SVGElement","BLOCK_CLASS","serializeNode","nodeType","DOCUMENT_NODE","type","Document","childNodes","DOCUMENT_TYPE_NODE","DocumentType","name","publicId","systemId","ELEMENT_NODE","needBlock","classList","contains","toLowerCase","attributes_1","_a","attributes","_b","value","location","stylesheet","styleSheets","find","_cssText","checked","selectValue","parentElement","selected","_c","getBoundingClientRect","width","height","rr_width","rr_height","Element","isSVG","undefined","TEXT_NODE","parentTagName","parentNode","textContent","isStyle","Text","CDATA_SECTION_NODE","CDATA","COMMENT_NODE","Comment","serializeNodeWithId","map","skipChild","_serializedNode","console","warn","serializedNode","id","__sn","recordChild","childN","serializedChildNode","snapshot","idNodeMap","tagMap","script","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","clippath","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","fedropshadow","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","foreignobject","glyphref","lineargradient","radialgradient","getTagName","CSS_SELECTOR","HOVER_SELECTOR","addHoverClass","match","p1","p2","newSelector","buildNode","implementation","createDocument","createDocumentType","node","createElementNS","startsWith","isTextarea","isRemoteCss","child","createTextNode","appendChild","setAttribute","style","createCDATASection","createComment","buildNodeWithSN","close","open","childNode","rebuild","on","fn","target","document","options","capture","passive","addEventListener","removeEventListener","mirror","getId","getNode","removeNodeFromMap","forEach","has","throttle","func","wait","timeout","previous","now","Date","leading","remaining","context","args","window","clearTimeout","trailing","setTimeout","hookSetter","key","d","original","getOwnPropertyDescriptor","defineProperty","set","_this","getWindowHeight","innerHeight","documentElement","clientHeight","body","getWindowWidth","innerWidth","clientWidth","EventType","IncrementalSource","MouseInteractions","ReplayerEvents","BLOCK_CLASS$1","isBlocked","isAncestorRemoved","deepDelete","addsSet","isParentRemoved","removes","parentId","some","r","isParentDropped","droppedSet","initMutationObserver","cb","observer","MutationObserver","mutations","texts","adds","Set","genAdds","add","mutation","oldValue","addedNodes","removedNodes","attributeName","getAttribute","item","nodeId","previousId","previousSibling","nextId","nextSibling","payload","text","filter","attribute","observe","attributeOldValue","characterData","characterDataOldValue","childList","subtree","initMousemoveObserver","positions","timeBaseline","wrappedCb","totalOffset","timeOffset","evt","clientX","clientY","x","y","initMouseInteractionObserver","handlers","keys","Number","isNaN","eventKey","eventName","handler","event","getHandler","h","initScrollObserver","scrollEl","scrollingElement","scrollLeft","scrollTop","initViewportResizeObserver","INPUT_TAGS","HOOK_PROPERTIES","HTMLInputElement","HTMLSelectElement","HTMLTextAreaElement","IGNORE_CLASS","lastInputValueMap","WeakMap","initInputObserver","eventHandler","isChecked","cbWithDedup","querySelectorAll","v","lastInputValue","get","propertyDescriptor","initObservers","o","mutationObserver","mutationCb","mousemoveHandler","mousemoveCb","mouseInteractionHandler","mouseInteractionCb","scrollHandler","scrollCb","viewportResizeHandler","viewportResizeCb","inputHandler","inputCb","disconnect","wrapEvent","e","timestamp","record","emit","lastFullSnapshotEvent","checkoutEveryNms","checkoutEveryNth","Error","incrementalSnapshotCount","wrappedEmit","isCheckout","FullSnapshot","IncrementalSnapshot","exceedCount","exceedTime","takeFullSnapshot","Meta","data","initialOffset","left","top","handlers_1","DomContentLoaded","init_1","m","source","Mutation","MouseMove","MouseInteraction","Scroll","ViewportResize","Input","readyState","Load","mitt","all","create","off","splice","mittProxy","freeze","default","createCommonjsModule","module","exports","smoothscroll","polyfill","w","__forceSmoothScrollPolyfill__","userAgent","HTMLElement","SCROLL_TIME","scroll","scrollTo","scrollBy","elementScroll","scrollElement","scrollIntoView","performance","bind","ROUNDING_TOLERANCE","navigator","RegExp","shouldBailOut","smoothScroll","scrollX","pageXOffset","scrollY","pageYOffset","SyntaxError","behavior","scrollableParent","findScrollableParent","isBody","isScrollable","parentRects","clientRects","getComputedStyle","position","firstArg","TypeError","hasScrollableSpace","axis","scrollHeight","scrollWidth","canOverflow","overflowValue","isScrollableY","isScrollableX","step","time","currentX","currentY","k","elapsed","startTime","Math","cos","PI","startX","startY","method","scrollable","requestAnimationFrame","smoothscroll_1","Timer","config","actions","addAction","action","index","findActionIndex","addActions","start","sort","a1","a2","delay","lastTimestamp","self","raf","check","speed","shift","doAction","clear","cancelAnimationFrame","end","mid","floor","SKIP_TIME_THRESHOLD","SKIP_TIME_INTERVAL","mitt$1","REPLAY_CONSOLE_PREFIX","Replayer","events","emitter","baselineTime","noramlSpeed","missingNodeRetryMap","handleResize","defaultConfig","root","loadTimeout","skipInactive","showWarning","showDebug","timer","setupDom","setConfig","getMetaData","firstEvent","totalTime","getTimeOffset","play","isSync","castFn","getCastFn","getDelay","Start","pause","Pause","resume","lastPlayedEvent","Resume","wrapper","mouse","iframe","dimension","firstOffset","firstTimestamp","Resize","rebuildFullSnapshot","contentWindow","applyIncremental","nextUserInteractionEvent","restoreSpeed","_event","isUserInteraction","skipTime","min","round","SkipStart","wrappedCastFn","Finish","contentDocument","styleEl","head","insertBefore","idx","sheet","insertRule","FullsnapshotRebuilded","waitForStylesheetLoad","unloadSheets_1","timer_1","css","size","LoadStylesheetStart","LoadStylesheetEnd","warnNodeNotFound","parent","removeChild","missingNodeMap_1","next","resolveMissingNode","removeAttribute","moveAndHover","Event","debugNodeNotFound","Blur","blur","Focus","focus","preventScroll","Click","remove","offsetWidth","dispatchEvent","targetMutation","previousInMap","nextInMap","hoverElements","hoveredEl","currentEl","SkipEnd","log"],"mappings":"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","file":"src.9caef6c7.js","sourceRoot":"../examples","sourcesContent":["(function (name, context, definition) {\n  if (typeof module !== 'undefined' && module.exports) module.exports = definition();\n  else if (typeof define === 'function' && define.amd) define(definition);\n  else context[name] = definition();\n})('urljoin', this, function () {\n\n  function normalize (strArray) {\n    var resultArray = [];\n\n    // If the first part is a plain protocol, we combine it with the next part.\n    if (strArray[0].match(/^[^/:]+:\\/*$/) && strArray.length > 1) {\n      var first = strArray.shift();\n      strArray[0] = first + strArray[0];\n    }\n\n    // There must be two or three slashes in the file protocol, two slashes in anything else.\n    if (strArray[0].match(/^file:\\/\\/\\//)) {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1:///');\n    } else {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1://');\n    }\n\n    for (var i = 0; i < strArray.length; i++) {\n      var component = strArray[i];\n\n      if (typeof component !== 'string') {\n        throw new TypeError('Url must be a string. Received ' + component);\n      }\n\n      if (component === '') { continue; }\n\n      if (i > 0) {\n        // Removing the starting slashes for each component but the first.\n        component = component.replace(/^[\\/]+/, '');\n      }\n      if (i < strArray.length - 1) {\n        // Removing the ending slashes for each component but the last.\n        component = component.replace(/[\\/]+$/, '');\n      } else {\n        // For the last component we will combine multiple slashes to a single one.\n        component = component.replace(/[\\/]+$/, '/');\n      }\n\n      resultArray.push(component);\n\n    }\n\n    var str = resultArray.join('/');\n    // Each input component is now separated by a single slash except the possible first plain protocol part.\n\n    // remove trailing slash before parameters or hash\n    str = str.replace(/\\/(\\?|&|#[^!])/g, '$1');\n\n    // replace ? in parameters with &\n    var parts = str.split('?');\n    str = parts.shift() + (parts.length > 0 ? '?': '') + parts.join('&');\n\n    return str;\n  }\n\n  return function () {\n    var input;\n\n    if (typeof arguments[0] === 'object') {\n      input = arguments[0];\n    } else {\n      input = [].slice.call(arguments);\n    }\n\n    return normalize(input);\n  };\n\n});\n","import urlJoin from \"url-join\"\n\nexport class Util {\n  static async streamWebcamGet(): Promise<MediaStream> {\n    const mediaSource = new MediaSource()\n\n    // TODO make webcam constraints configurable\n    var constraints = {\n      audio: false,\n      video: {\n        width: {\n          min: 320,\n          ideal: 640,\n          max: 800\n        },\n        height: {\n          min: 240,\n          ideal: 480,\n          max: 600\n        },\n        frameRate: {\n          ideal: 15,\n          max: 20\n        },\n        facingMode: \"user\"\n      }\n    }\n\n    const stream = await navigator.mediaDevices.getUserMedia(constraints)\n    return stream\n  }\n  static streamDisplayGet(): Promise<MediaStream> {\n    return navigator.mediaDevices.getDisplayMedia({\n      video: {\n        frameRate: {\n          // ideal: 20\n          ideal: 1\n        }\n      }\n    })\n  }\n  static streamAttachToVideoElement(stream: MediaStream, video: HTMLVideoElement) {\n    video.srcObject = stream\n    video.volume = 0\n    video.play()\n  }\n  static streamToVideo(stream: MediaStream | undefined): HTMLVideoElement {\n    const video = document.createElement('video')\n    if (stream) {\n      this.streamAttachToVideoElement(stream, video)\n    }\n    return video\n  }\n  static async blobUpload(\n    blob: Blob,\n    tsStart: number = Date.now(),\n    tsEnd: number = Date.now(),\n    url: string = \"https://server-example-hnsgjqduut.now.sh/upload\"\n  ) {\n    var fd = new FormData()\n    fd.append('file', blob)\n    fd.append('blobType', blob.type)\n    fd.append('tsStart', tsStart.toString())\n    fd.append('tsEnd', tsEnd.toString())\n    // TODO: sent blob.type and ts\n    await fetch(url, {\n      body: fd,\n      method: 'post'\n    })\n  }\n  static async rrWebEventsUpload(\n    events: any[],\n    tsStart: number = Date.now(),\n    tsEnd: number = Date.now(),\n    url: string = \"https://server-example-hnsgjqduut.now.sh/upload\"\n  ) {\n    var fd = new FormData()\n    fd.append('events', JSON.stringify(events, null, 2))\n    fd.append('tsStart', tsStart.toString())\n    fd.append('tsEnd', tsEnd.toString())\n    // TODO: sent blob.type and ts\n    await fetch(url, {\n      body: fd,\n      method: 'post'\n    })\n  }\n  static async blobDownload(blob: Blob) {\n    // TODO: create method to save stream to file\n    var url = window.URL.createObjectURL(blob)\n    var a = document.createElement('a')\n    a.style.display = 'none'\n    a.href = url\n    a.download = 'test.webm'\n    document.body.appendChild(a)\n    a.click()\n    setTimeout(() => {\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n    }, 100)\n  }\n  static urlJoin(...tokens: string[]) {\n    return urlJoin(...tokens)\n  }\n}\n","export class CanvasRenderer {\n  readonly context: CanvasRenderingContext2D\n  private interval: any\n  constructor(\n    private canvas: HTMLCanvasElement,\n    private video: HTMLVideoElement,\n    private videoSecondary: HTMLVideoElement | undefined = undefined\n  ) {\n    this.context = canvas.getContext('2d')!\n  }\n  start = (frameDurationMs: number) => {\n    this.stop()\n    this.interval = setInterval(this.draw, frameDurationMs)\n  }\n  stop = () => {\n    if (this.interval) {\n      clearInterval(this.interval)\n    }\n    this.interval = null\n  }\n  private draw = () => {\n    const [canvas, video, secondary, context] = [this.canvas, this.video, this.videoSecondary, this.context]\n    const width = video.videoWidth\n    const height = video.videoHeight\n    canvas.width = width\n    canvas.height = height\n    context.drawImage(video, 0, 0, width, height)\n    if (secondary != undefined) {\n      const margin = width / 40\n      const aspectRatio = secondary.videoHeight / secondary.videoWidth\n      const secondaryWidth = width / 3\n      const secondaryHeight = (width / 3) * aspectRatio\n      context.drawImage(\n        secondary,\n        width - (secondaryWidth + margin),\n        height - (secondaryHeight + margin),\n        width / 3,\n        (width / 3) * aspectRatio\n      )\n    }\n  }\n}\n","export class Disposable {\n  disposables: Disposable[] = []\n\n  public dispose() {\n    this.disposables.forEach(d => d.dispose())\n    this.disposables = []\n  }\n}\n","export class Logger {\n  constructor(private scope: String) { }\n  debug = (...args: any[]) => { console.log(this.scope, ...args) }\n}\n","export class TimestampProvider {\n  ts() { return Date.now() }\n}\n","import { Logger } from './Logger'\nimport { Disposable } from './Disposable'\nimport { TimestampProvider } from './TimestampProvider'\n\nexport class StreamRecorderRecording {\n  constructor(\n    public tsStart: number,\n    public tsEnd: number,\n    public blob: Blob\n    ) { }\n  }\n  \nexport default class StreamRecorder extends Disposable {\n  stream: MediaStream\n  recorder: MediaRecorder\n  timestampProvider = new TimestampProvider()\n  logger = new Logger(\"StreamRecorder\")\n\n  recordedBlobs: any[]\n  sizeTotal: number\n  tsStart: number = this.timestampProvider.ts()\n  tsEnd: number = this.timestampProvider.ts()\n  mimeTypeSelected: string = 'video/webm;codecs=vp9'\n  candidates: any[] = [{\n      mimeType: 'video/webm;codecs=vp9',\n      bitsPerSecond: 100000\n    }, {\n      mimeType: 'video/webm;codecs=vp8',\n      bitsPerSecond: 100000\n    },\n    'video/mp4'\n  ]\n\n  constructor(stream: MediaStream) {\n    super()\n    this.stream = stream\n    for (const candidate of this.candidates) {\n      try {\n        this.recorder = new MediaRecorder(stream, candidate)\n        this.logger.debug(`negotiating recording caps: ${JSON.stringify(candidate)}`)\n        if (typeof(candidate) == 'string') {\n          this.mimeTypeSelected = candidate\n        } else {\n          this.mimeTypeSelected = candidate.mimeType\n        }\n        break\n      } catch (e) {}\n    }\n    this.recordedBlobs = []\n    this.recorder.ondataavailable = this.onDataAvailable\n  }\n  private onDataAvailable = (event: any) => {\n    // NOTE: some release of chrome call this method quite often, almost at every frame\n    // which allows to track the buffer timestamp and understand recording start/end\n    // but some other chrome versions call this once every 30s, so the above can't be\n    // done reliably, sadly.\n    if (event.data && event.data.size > 0) {\n      this.sizeTotal += event.data.size\n      this.logger.debug(\"recording size\", this.sizeTotal)\n      this.recordedBlobs.push(event.data)\n    }\n  }\n  public start = () => {\n    this.logger.debug(\"start\")\n    this.tsStart = this.timestampProvider.ts()\n    this.sizeTotal = 0\n    this.recorder.start()\n  }\n  public stop = (): Promise<StreamRecorderRecording> => {\n    this.logger.debug(\"stop\")\n    this.tsEnd = this.timestampProvider.ts()\n    return new Promise((resolve: any) => {\n      this.recorder.onstop = () => {\n        var superBuffer = new Blob(this.recordedBlobs, { type: this.mimeTypeSelected })\n        this.recordedBlobs = []\n        // TODO: send tsStart (actual start of the recording) and tsEnd (actual end of the recording)\n        const recording = new StreamRecorderRecording(\n          this.tsStart, this.tsEnd, superBuffer\n        )\n        resolve(recording)\n      }\n      this.recorder.stop()\n    })\n  }\n  dispose() {\n    super.dispose()\n    if (this.recorder.state == \"inactive\") {\n      this.stop()\n    }\n  }\n}","import { Logger } from './Logger'\nimport StreamRecorder from './StreamRecorder'\nimport { StreamRecorderRecording } from './StreamRecorder'\nimport { Disposable } from './Disposable'\n\nexport class StreamSegmenter extends Disposable {\n  recorder: StreamRecorder\n  timeout: any\n  logger = new Logger(\"MediaStreamSegmenter\")\n  constructor(\n    private stream: MediaStream,\n    private segmentDurationMs: number,\n    private onBlob: (blob: StreamRecorderRecording) => void\n  ) {\n    super()\n    this.recorder = new StreamRecorder(stream)\n  }\n  start = () => {\n    this.logger.debug(\"start\")\n    this.recorder.start()\n    this.scheduleSplit()\n  }\n  private unscheduleSplit = () => {\n    clearTimeout(this.timeout)\n    this.timeout = null\n  }\n  private scheduleSplit = () => {\n    this.unscheduleSplit()\n    this.timeout = setTimeout(this.split, this.segmentDurationMs)\n  }\n  private split = async () => {\n    this.scheduleSplit()\n    const recorderOld = this.recorder\n    this.recorder = new StreamRecorder(this.stream)\n    this.recorder.start()\n    const recording = await recorderOld.stop()\n    this.onBlob(recording)\n    return await true\n  }\n  stop = async () => {\n    this.logger.debug(\"stop\")\n    this.unscheduleSplit()\n    const recording = await this.recorder.stop()\n    this.onBlob(recording)\n    return await true\n  }\n  dispose = () => {\n    this.stop()\n    super.dispose()\n  }\n}\n","import { record } from 'rrweb'\nimport { Util } from \"./Util\"\nimport { CanvasRenderer } from \"./CanvasRenderer\"\nimport { Disposable } from \"./Disposable\"\nimport { StreamSegmenter } from \"./StreamSegmenter\"\nimport { Logger } from \"./Logger\"\n\nexport class WebRecorderWorkflow0 extends Disposable {\n  logger = new Logger('WebRecorderWorkflow0')\n\n  start = async (canvas: HTMLCanvasElement) => {\n    this.logger.debug('launching')\n\n    const desktopStream = await Util.streamDisplayGet().catch(err => undefined)\n    const webcamStream = await Util.streamWebcamGet().catch(err => undefined)\n\n    const [desktopUploader, webcamUploader] = [desktopStream, webcamStream].map(stream => {\n      if (stream == null) {\n        return\n      }\n      this.logger.debug(\"stream video settings\", stream.getVideoTracks()[0].getSettings())\n      const streamUploader = new StreamSegmenter(stream, 30 * 1000, (recording) => {\n        Util.blobUpload(recording.blob)\n        Util.blobDownload(recording.blob)\n      })\n      streamUploader.start()\n      streamUploader\n    })\n    // renders a primary and a secondaty <video> in a <canvas> with given framerate\n    if (webcamStream || desktopStream) {\n      const canvasRenderer = new CanvasRenderer(canvas, Util.streamToVideo(webcamStream || desktopStream), Util.streamToVideo(desktopStream || webcamStream))\n      canvasRenderer.start(100)\n      const canvasStream = canvas.captureStream(10)\n    }\n  }\n\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Document\"] = 0] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\n    NodeType[NodeType[\"Element\"] = 2] = \"Element\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\n    NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\n})(NodeType || (NodeType = {}));\n\nvar _id = 1;\nfunction genId() {\n    return _id++;\n}\nfunction resetId() {\n    _id = 1;\n}\nfunction getCssRulesString(s) {\n    try {\n        var rules = s.rules || s.cssRules;\n        return rules\n            ? Array.from(rules).reduce(function (prev, cur) { return (prev += cur.cssText); }, '')\n            : null;\n    }\n    catch (error) {\n        return null;\n    }\n}\nfunction extractOrigin(url) {\n    var origin;\n    if (url.indexOf('//') > -1) {\n        origin = url\n            .split('/')\n            .slice(0, 3)\n            .join('/');\n    }\n    else {\n        origin = url.split('/')[0];\n    }\n    origin = origin.split('?')[0];\n    return origin;\n}\nvar URL_IN_CSS_REF = /url\\((?:'([^']*)'|\"([^\"]*)\"|([^)]*))\\)/gm;\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/).*/;\nvar DATA_URI = /^(data:)([\\w\\/\\+]+);(charset=[\\w-]+|base64).*,(.*)/gi;\nfunction absoluteToStylesheet(cssText, href) {\n    return cssText.replace(URL_IN_CSS_REF, function (origin, path1, path2, path3) {\n        var filePath = path1 || path2 || path3;\n        if (!filePath) {\n            return origin;\n        }\n        if (!RELATIVE_PATH.test(filePath)) {\n            return \"url('\" + filePath + \"')\";\n        }\n        if (DATA_URI.test(filePath)) {\n            return \"url(\" + filePath + \")\";\n        }\n        if (filePath[0] === '/') {\n            return \"url('\" + (extractOrigin(href) + filePath) + \"')\";\n        }\n        var stack = href.split('/');\n        var parts = filePath.split('/');\n        stack.pop();\n        for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\n            var part = parts_1[_i];\n            if (part === '.') {\n                continue;\n            }\n            else if (part === '..') {\n                stack.pop();\n            }\n            else {\n                stack.push(part);\n            }\n        }\n        return \"url('\" + stack.join('/') + \"')\";\n    });\n}\nfunction absoluteToDoc(doc, attributeValue) {\n    var a = doc.createElement('a');\n    a.href = attributeValue;\n    return a.href;\n}\nfunction isSVGElement(el) {\n    return el.tagName === 'svg' || el instanceof SVGElement;\n}\nvar BLOCK_CLASS = 'rr-block';\nfunction serializeNode(n, doc) {\n    switch (n.nodeType) {\n        case n.DOCUMENT_NODE:\n            return {\n                type: NodeType.Document,\n                childNodes: []\n            };\n        case n.DOCUMENT_TYPE_NODE:\n            return {\n                type: NodeType.DocumentType,\n                name: n.name,\n                publicId: n.publicId,\n                systemId: n.systemId\n            };\n        case n.ELEMENT_NODE:\n            var needBlock = n.classList.contains(BLOCK_CLASS);\n            var tagName = n.tagName.toLowerCase();\n            var attributes_1 = {};\n            for (var _i = 0, _a = Array.from(n.attributes); _i < _a.length; _i++) {\n                var _b = _a[_i], name = _b.name, value = _b.value;\n                if (name === 'src' || name === 'href') {\n                    attributes_1[name] = absoluteToDoc(doc, value);\n                }\n                else if (name === 'style') {\n                    attributes_1[name] = absoluteToStylesheet(value, location.href);\n                }\n                else {\n                    attributes_1[name] = value;\n                }\n            }\n            if (tagName === 'link') {\n                var stylesheet = Array.from(doc.styleSheets).find(function (s) {\n                    return s.href === n.href;\n                });\n                var cssText = getCssRulesString(stylesheet);\n                if (cssText) {\n                    attributes_1 = {\n                        _cssText: absoluteToStylesheet(cssText, stylesheet.href)\n                    };\n                }\n            }\n            if (tagName === 'input' ||\n                tagName === 'textarea' ||\n                tagName === 'select') {\n                var value = n.value;\n                if (attributes_1.type !== 'radio' &&\n                    attributes_1.type !== 'checkbox' &&\n                    value) {\n                    attributes_1.value = value;\n                }\n                else if (n.checked) {\n                    attributes_1.checked = n.checked;\n                }\n            }\n            if (tagName === 'option') {\n                var selectValue = n.parentElement;\n                if (attributes_1.value === selectValue.value) {\n                    attributes_1.selected = n.selected;\n                }\n            }\n            if (needBlock) {\n                var _c = n.getBoundingClientRect(), width = _c.width, height = _c.height;\n                attributes_1.rr_width = width + \"px\";\n                attributes_1.rr_height = height + \"px\";\n            }\n            return {\n                type: NodeType.Element,\n                tagName: tagName,\n                attributes: attributes_1,\n                childNodes: [],\n                isSVG: isSVGElement(n) || undefined,\n                needBlock: needBlock\n            };\n        case n.TEXT_NODE:\n            var parentTagName = n.parentNode && n.parentNode.tagName;\n            var textContent = n.textContent;\n            var isStyle = parentTagName === 'STYLE' ? true : undefined;\n            if (isStyle && textContent) {\n                textContent = absoluteToStylesheet(textContent, location.href);\n            }\n            if (parentTagName === 'SCRIPT') {\n                textContent = 'SCRIPT_PLACEHOLDER';\n            }\n            return {\n                type: NodeType.Text,\n                textContent: textContent || '',\n                isStyle: isStyle\n            };\n        case n.CDATA_SECTION_NODE:\n            return {\n                type: NodeType.CDATA,\n                textContent: ''\n            };\n        case n.COMMENT_NODE:\n            return {\n                type: NodeType.Comment,\n                textContent: n.textContent || ''\n            };\n        default:\n            return false;\n    }\n}\nfunction serializeNodeWithId(n, doc, map, skipChild) {\n    if (skipChild === void 0) { skipChild = false; }\n    var _serializedNode = serializeNode(n, doc);\n    if (!_serializedNode) {\n        console.warn(n, 'not serialized');\n        return null;\n    }\n    var serializedNode = Object.assign(_serializedNode, {\n        id: genId()\n    });\n    n.__sn = serializedNode;\n    map[serializedNode.id] = n;\n    var recordChild = !skipChild;\n    if (serializedNode.type === NodeType.Element) {\n        recordChild = recordChild && !serializedNode.needBlock;\n        delete serializedNode.needBlock;\n    }\n    if ((serializedNode.type === NodeType.Document ||\n        serializedNode.type === NodeType.Element) &&\n        recordChild) {\n        for (var _i = 0, _a = Array.from(n.childNodes); _i < _a.length; _i++) {\n            var childN = _a[_i];\n            var serializedChildNode = serializeNodeWithId(childN, doc, map);\n            if (serializedChildNode) {\n                serializedNode.childNodes.push(serializedChildNode);\n            }\n        }\n    }\n    return serializedNode;\n}\nfunction snapshot(n) {\n    resetId();\n    var idNodeMap = {};\n    return [serializeNodeWithId(n, n, idNodeMap), idNodeMap];\n}\n\nvar tagMap = {\n    script: 'noscript',\n    altglyph: 'altGlyph',\n    altglyphdef: 'altGlyphDef',\n    altglyphitem: 'altGlyphItem',\n    animatecolor: 'animateColor',\n    animatemotion: 'animateMotion',\n    animatetransform: 'animateTransform',\n    clippath: 'clipPath',\n    feblend: 'feBlend',\n    fecolormatrix: 'feColorMatrix',\n    fecomponenttransfer: 'feComponentTransfer',\n    fecomposite: 'feComposite',\n    feconvolvematrix: 'feConvolveMatrix',\n    fediffuselighting: 'feDiffuseLighting',\n    fedisplacementmap: 'feDisplacementMap',\n    fedistantlight: 'feDistantLight',\n    fedropshadow: 'feDropShadow',\n    feflood: 'feFlood',\n    fefunca: 'feFuncA',\n    fefuncb: 'feFuncB',\n    fefuncg: 'feFuncG',\n    fefuncr: 'feFuncR',\n    fegaussianblur: 'feGaussianBlur',\n    feimage: 'feImage',\n    femerge: 'feMerge',\n    femergenode: 'feMergeNode',\n    femorphology: 'feMorphology',\n    feoffset: 'feOffset',\n    fepointlight: 'fePointLight',\n    fespecularlighting: 'feSpecularLighting',\n    fespotlight: 'feSpotLight',\n    fetile: 'feTile',\n    feturbulence: 'feTurbulence',\n    foreignobject: 'foreignObject',\n    glyphref: 'glyphRef',\n    lineargradient: 'linearGradient',\n    radialgradient: 'radialGradient'\n};\nfunction getTagName(n) {\n    var tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\n    if (tagName === 'link' && n.attributes._cssText) {\n        tagName = 'style';\n    }\n    return tagName;\n}\nvar CSS_SELECTOR = /([^\\r\\n,{}]+)(,(?=[^}]*{)|\\s*{)/g;\nvar HOVER_SELECTOR = /([^\\\\]):hover/g;\nfunction addHoverClass(cssText) {\n    return cssText.replace(CSS_SELECTOR, function (match, p1, p2) {\n        if (HOVER_SELECTOR.test(p1)) {\n            var newSelector = p1.replace(HOVER_SELECTOR, '$1.\\\\:hover');\n            return p1.replace(/\\s*$/, '') + \", \" + newSelector.replace(/^\\s*/, '') + p2;\n        }\n        else {\n            return match;\n        }\n    });\n}\nfunction buildNode(n, doc) {\n    switch (n.type) {\n        case NodeType.Document:\n            return doc.implementation.createDocument(null, '', null);\n        case NodeType.DocumentType:\n            return doc.implementation.createDocumentType(n.name, n.publicId, n.systemId);\n        case NodeType.Element:\n            var tagName = getTagName(n);\n            var node = void 0;\n            if (n.isSVG) {\n                node = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\n            }\n            else {\n                node = doc.createElement(tagName);\n            }\n            for (var name in n.attributes) {\n                if (n.attributes.hasOwnProperty(name) && !name.startsWith('rr_')) {\n                    var value = n.attributes[name];\n                    value = typeof value === 'boolean' ? '' : value;\n                    var isTextarea = tagName === 'textarea' && name === 'value';\n                    var isRemoteCss = tagName === 'style' && name === '_cssText';\n                    if (isRemoteCss) {\n                        value = addHoverClass(value);\n                    }\n                    if (isTextarea || isRemoteCss) {\n                        var child = doc.createTextNode(value);\n                        node.appendChild(child);\n                        continue;\n                    }\n                    if (tagName === 'iframe' && name === 'src') {\n                        continue;\n                    }\n                    try {\n                        node.setAttribute(name, value);\n                    }\n                    catch (error) {\n                    }\n                }\n                else {\n                    if (n.attributes.rr_width) {\n                        node.style.width = n.attributes.rr_width;\n                    }\n                    if (n.attributes.rr_height) {\n                        node.style.height = n.attributes\n                            .rr_height;\n                    }\n                }\n            }\n            return node;\n        case NodeType.Text:\n            return doc.createTextNode(n.isStyle ? addHoverClass(n.textContent) : n.textContent);\n        case NodeType.CDATA:\n            return doc.createCDATASection(n.textContent);\n        case NodeType.Comment:\n            return doc.createComment(n.textContent);\n        default:\n            return null;\n    }\n}\nfunction buildNodeWithSN(n, doc, map, skipChild) {\n    if (skipChild === void 0) { skipChild = false; }\n    var node = buildNode(n, doc);\n    if (!node) {\n        return null;\n    }\n    if (n.type === NodeType.Document) {\n        doc.close();\n        doc.open();\n        node = doc;\n    }\n    node.__sn = n;\n    map[n.id] = node;\n    if ((n.type === NodeType.Document || n.type === NodeType.Element) &&\n        !skipChild) {\n        for (var _i = 0, _a = n.childNodes; _i < _a.length; _i++) {\n            var childN = _a[_i];\n            var childNode = buildNodeWithSN(childN, doc, map);\n            if (!childNode) {\n                console.warn('Failed to rebuild', childN);\n            }\n            else {\n                node.appendChild(childNode);\n            }\n        }\n    }\n    return node;\n}\nfunction rebuild(n, doc) {\n    var idNodeMap = {};\n    return [buildNodeWithSN(n, doc, idNodeMap), idNodeMap];\n}\n\nfunction on(type, fn, target) {\n    if (target === void 0) { target = document; }\n    var options = { capture: true, passive: true };\n    target.addEventListener(type, fn, options);\n    return function () { return target.removeEventListener(type, fn, options); };\n}\nvar mirror = {\n    map: {},\n    getId: function (n) {\n        if (!n.__sn) {\n            return -1;\n        }\n        return n.__sn.id;\n    },\n    getNode: function (id) {\n        return mirror.map[id] || null;\n    },\n    removeNodeFromMap: function (n) {\n        var id = n.__sn && n.__sn.id;\n        delete mirror.map[id];\n        if (n.childNodes) {\n            n.childNodes.forEach(function (child) {\n                return mirror.removeNodeFromMap(child);\n            });\n        }\n    },\n    has: function (id) {\n        return mirror.map.hasOwnProperty(id);\n    }\n};\nfunction throttle(func, wait, options) {\n    if (options === void 0) { options = {}; }\n    var timeout = null;\n    var previous = 0;\n    return function () {\n        var now = Date.now();\n        if (!previous && options.leading === false) {\n            previous = now;\n        }\n        var remaining = wait - (now - previous);\n        var context = this;\n        var args = arguments;\n        if (remaining <= 0 || remaining > wait) {\n            if (timeout) {\n                window.clearTimeout(timeout);\n                timeout = null;\n            }\n            previous = now;\n            func.apply(context, args);\n        }\n        else if (!timeout && options.trailing !== false) {\n            timeout = window.setTimeout(function () {\n                previous = options.leading === false ? 0 : Date.now();\n                timeout = null;\n                func.apply(context, args);\n            }, remaining);\n        }\n    };\n}\nfunction hookSetter(target, key, d) {\n    var original = Object.getOwnPropertyDescriptor(target, key);\n    Object.defineProperty(target, key, {\n        set: function (value) {\n            var _this = this;\n            setTimeout(function () {\n                d.set.call(_this, value);\n            }, 0);\n            if (original && original.set) {\n                original.set.call(this, value);\n            }\n        }\n    });\n    return function () { return hookSetter(target, key, original || {}); };\n}\nfunction getWindowHeight() {\n    return (window.innerHeight ||\n        (document.documentElement && document.documentElement.clientHeight) ||\n        (document.body && document.body.clientHeight));\n}\nfunction getWindowWidth() {\n    return (window.innerWidth ||\n        (document.documentElement && document.documentElement.clientWidth) ||\n        (document.body && document.body.clientWidth));\n}\nvar BLOCK_CLASS$1 = 'rr-block';\nfunction isBlocked(node) {\n    if (!node) {\n        return false;\n    }\n    if (node.nodeType === node.ELEMENT_NODE) {\n        return (node.classList.contains(BLOCK_CLASS$1) ||\n            isBlocked(node.parentNode));\n    }\n    return isBlocked(node.parentNode);\n}\nfunction isAncestorRemoved(target) {\n    var id = mirror.getId(target);\n    if (!mirror.has(id)) {\n        return true;\n    }\n    if (target.parentNode &&\n        target.parentNode.nodeType === target.DOCUMENT_NODE) {\n        return false;\n    }\n    if (!target.parentNode) {\n        return true;\n    }\n    return isAncestorRemoved(target.parentNode);\n}\n\nvar EventType;\n(function (EventType) {\n    EventType[EventType[\"DomContentLoaded\"] = 0] = \"DomContentLoaded\";\n    EventType[EventType[\"Load\"] = 1] = \"Load\";\n    EventType[EventType[\"FullSnapshot\"] = 2] = \"FullSnapshot\";\n    EventType[EventType[\"IncrementalSnapshot\"] = 3] = \"IncrementalSnapshot\";\n    EventType[EventType[\"Meta\"] = 4] = \"Meta\";\n})(EventType || (EventType = {}));\nvar IncrementalSource;\n(function (IncrementalSource) {\n    IncrementalSource[IncrementalSource[\"Mutation\"] = 0] = \"Mutation\";\n    IncrementalSource[IncrementalSource[\"MouseMove\"] = 1] = \"MouseMove\";\n    IncrementalSource[IncrementalSource[\"MouseInteraction\"] = 2] = \"MouseInteraction\";\n    IncrementalSource[IncrementalSource[\"Scroll\"] = 3] = \"Scroll\";\n    IncrementalSource[IncrementalSource[\"ViewportResize\"] = 4] = \"ViewportResize\";\n    IncrementalSource[IncrementalSource[\"Input\"] = 5] = \"Input\";\n})(IncrementalSource || (IncrementalSource = {}));\nvar MouseInteractions;\n(function (MouseInteractions) {\n    MouseInteractions[MouseInteractions[\"MouseUp\"] = 0] = \"MouseUp\";\n    MouseInteractions[MouseInteractions[\"MouseDown\"] = 1] = \"MouseDown\";\n    MouseInteractions[MouseInteractions[\"Click\"] = 2] = \"Click\";\n    MouseInteractions[MouseInteractions[\"ContextMenu\"] = 3] = \"ContextMenu\";\n    MouseInteractions[MouseInteractions[\"DblClick\"] = 4] = \"DblClick\";\n    MouseInteractions[MouseInteractions[\"Focus\"] = 5] = \"Focus\";\n    MouseInteractions[MouseInteractions[\"Blur\"] = 6] = \"Blur\";\n    MouseInteractions[MouseInteractions[\"TouchStart\"] = 7] = \"TouchStart\";\n    MouseInteractions[MouseInteractions[\"TouchMove\"] = 8] = \"TouchMove\";\n    MouseInteractions[MouseInteractions[\"TouchEnd\"] = 9] = \"TouchEnd\";\n})(MouseInteractions || (MouseInteractions = {}));\nvar ReplayerEvents;\n(function (ReplayerEvents) {\n    ReplayerEvents[\"Start\"] = \"start\";\n    ReplayerEvents[\"Pause\"] = \"pause\";\n    ReplayerEvents[\"Resume\"] = \"resume\";\n    ReplayerEvents[\"Resize\"] = \"resize\";\n    ReplayerEvents[\"Finish\"] = \"finish\";\n    ReplayerEvents[\"FullsnapshotRebuilded\"] = \"fullsnapshot-rebuilded\";\n    ReplayerEvents[\"LoadStylesheetStart\"] = \"load-stylesheet-start\";\n    ReplayerEvents[\"LoadStylesheetEnd\"] = \"load-stylesheet-end\";\n    ReplayerEvents[\"SkipStart\"] = \"skip-start\";\n    ReplayerEvents[\"SkipEnd\"] = \"skip-end\";\n})(ReplayerEvents || (ReplayerEvents = {}));\n\nfunction deepDelete(addsSet, n) {\n    addsSet[\"delete\"](n);\n    n.childNodes.forEach(function (childN) { return deepDelete(addsSet, childN); });\n}\nfunction isParentRemoved(removes, n) {\n    var parentNode = n.parentNode;\n    if (!parentNode) {\n        return false;\n    }\n    var parentId = mirror.getId(parentNode);\n    if (removes.some(function (r) { return r.id === parentId; })) {\n        return true;\n    }\n    return isParentRemoved(removes, parentNode);\n}\nfunction isParentDropped(droppedSet, n) {\n    var parentNode = n.parentNode;\n    if (!parentNode) {\n        return false;\n    }\n    if (droppedSet.has(parentNode)) {\n        return true;\n    }\n    return isParentDropped(droppedSet, parentNode);\n}\n\nfunction initMutationObserver(cb) {\n    var observer = new MutationObserver(function (mutations) {\n        var texts = [];\n        var attributes = [];\n        var removes = [];\n        var adds = [];\n        var addsSet = new Set();\n        var droppedSet = new Set();\n        var genAdds = function (n) {\n            if (isBlocked(n)) {\n                return;\n            }\n            addsSet.add(n);\n            droppedSet[\"delete\"](n);\n            n.childNodes.forEach(function (childN) { return genAdds(childN); });\n        };\n        mutations.forEach(function (mutation) {\n            var type = mutation.type, target = mutation.target, oldValue = mutation.oldValue, addedNodes = mutation.addedNodes, removedNodes = mutation.removedNodes, attributeName = mutation.attributeName;\n            switch (type) {\n                case 'characterData': {\n                    var value = target.textContent;\n                    if (!isBlocked(target) && value !== oldValue) {\n                        texts.push({\n                            value: value,\n                            node: target\n                        });\n                    }\n                    break;\n                }\n                case 'attributes': {\n                    var value = target.getAttribute(attributeName);\n                    if (isBlocked(target) || value === oldValue) {\n                        return;\n                    }\n                    var item = attributes.find(function (a) { return a.node === target; });\n                    if (!item) {\n                        item = {\n                            node: target,\n                            attributes: {}\n                        };\n                        attributes.push(item);\n                    }\n                    item.attributes[attributeName] = value;\n                    break;\n                }\n                case 'childList': {\n                    addedNodes.forEach(function (n) { return genAdds(n); });\n                    removedNodes.forEach(function (n) {\n                        var nodeId = mirror.getId(n);\n                        var parentId = mirror.getId(target);\n                        if (isBlocked(n)) {\n                            return;\n                        }\n                        if (addsSet.has(n)) {\n                            deepDelete(addsSet, n);\n                            droppedSet.add(n);\n                        }\n                        else if (addsSet.has(target) && nodeId === -1) ;\n                        else if (isAncestorRemoved(target)) ;\n                        else {\n                            removes.push({\n                                parentId: parentId,\n                                id: nodeId\n                            });\n                        }\n                        mirror.removeNodeFromMap(n);\n                    });\n                    break;\n                }\n                default:\n                    break;\n            }\n        });\n        Array.from(addsSet).forEach(function (n) {\n            if (!isParentDropped(droppedSet, n) && !isParentRemoved(removes, n)) {\n                adds.push({\n                    parentId: mirror.getId(n.parentNode),\n                    previousId: !n.previousSibling\n                        ? n.previousSibling\n                        : mirror.getId(n.previousSibling),\n                    nextId: !n.nextSibling\n                        ? n.nextSibling\n                        : mirror.getId(n.nextSibling),\n                    node: serializeNodeWithId(n, document, mirror.map, true)\n                });\n            }\n            else {\n                droppedSet.add(n);\n            }\n        });\n        var payload = {\n            texts: texts\n                .map(function (text) { return ({\n                id: mirror.getId(text.node),\n                value: text.value\n            }); })\n                .filter(function (text) { return mirror.has(text.id); }),\n            attributes: attributes\n                .map(function (attribute) { return ({\n                id: mirror.getId(attribute.node),\n                attributes: attribute.attributes\n            }); })\n                .filter(function (attribute) { return mirror.has(attribute.id); }),\n            removes: removes,\n            adds: adds\n        };\n        if (!payload.texts.length &&\n            !payload.attributes.length &&\n            !payload.removes.length &&\n            !payload.adds.length) {\n            return;\n        }\n        cb(payload);\n    });\n    observer.observe(document, {\n        attributes: true,\n        attributeOldValue: true,\n        characterData: true,\n        characterDataOldValue: true,\n        childList: true,\n        subtree: true\n    });\n    return observer;\n}\nfunction initMousemoveObserver(cb) {\n    var positions = [];\n    var timeBaseline;\n    var wrappedCb = throttle(function () {\n        var totalOffset = Date.now() - timeBaseline;\n        cb(positions.map(function (p) {\n            p.timeOffset -= totalOffset;\n            return p;\n        }));\n        positions = [];\n        timeBaseline = null;\n    }, 500);\n    var updatePosition = throttle(function (evt) {\n        var clientX = evt.clientX, clientY = evt.clientY, target = evt.target;\n        if (!timeBaseline) {\n            timeBaseline = Date.now();\n        }\n        positions.push({\n            x: clientX,\n            y: clientY,\n            id: mirror.getId(target),\n            timeOffset: Date.now() - timeBaseline\n        });\n        wrappedCb();\n    }, 50, {\n        trailing: false\n    });\n    return on('mousemove', updatePosition);\n}\nfunction initMouseInteractionObserver(cb) {\n    var handlers = [];\n    var getHandler = function (eventKey) {\n        return function (event) {\n            if (isBlocked(event.target)) {\n                return;\n            }\n            var id = mirror.getId(event.target);\n            var clientX = event.clientX, clientY = event.clientY;\n            cb({\n                type: MouseInteractions[eventKey],\n                id: id,\n                x: clientX,\n                y: clientY\n            });\n        };\n    };\n    Object.keys(MouseInteractions)\n        .filter(function (key) { return Number.isNaN(Number(key)); })\n        .forEach(function (eventKey) {\n        var eventName = eventKey.toLowerCase();\n        var handler = getHandler(eventKey);\n        handlers.push(on(eventName, handler));\n    });\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initScrollObserver(cb) {\n    var updatePosition = throttle(function (evt) {\n        if (!evt.target || isBlocked(evt.target)) {\n            return;\n        }\n        var id = mirror.getId(evt.target);\n        if (evt.target === document) {\n            var scrollEl = (document.scrollingElement || document.documentElement);\n            cb({\n                id: id,\n                x: scrollEl.scrollLeft,\n                y: scrollEl.scrollTop\n            });\n        }\n        else {\n            cb({\n                id: id,\n                x: evt.target.scrollLeft,\n                y: evt.target.scrollTop\n            });\n        }\n    }, 100);\n    return on('scroll', updatePosition);\n}\nfunction initViewportResizeObserver(cb) {\n    var updateDimension = throttle(function () {\n        var height = getWindowHeight();\n        var width = getWindowWidth();\n        cb({\n            width: Number(width),\n            height: Number(height)\n        });\n    }, 200);\n    return on('resize', updateDimension, window);\n}\nvar INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nvar HOOK_PROPERTIES = [\n    [HTMLInputElement.prototype, 'value'],\n    [HTMLInputElement.prototype, 'checked'],\n    [HTMLSelectElement.prototype, 'value'],\n    [HTMLTextAreaElement.prototype, 'value'],\n];\nvar IGNORE_CLASS = 'rr-ignore';\nvar lastInputValueMap = new WeakMap();\nfunction initInputObserver(cb) {\n    function eventHandler(event) {\n        var target = event.target;\n        if (!target ||\n            !target.tagName ||\n            INPUT_TAGS.indexOf(target.tagName) < 0 ||\n            isBlocked(target)) {\n            return;\n        }\n        var type = target.type;\n        if (type === 'password' ||\n            target.classList.contains(IGNORE_CLASS)) {\n            return;\n        }\n        var text = target.value;\n        var isChecked = false;\n        if (type === 'radio' || type === 'checkbox') {\n            isChecked = target.checked;\n        }\n        cbWithDedup(target, { text: text, isChecked: isChecked });\n        var name = target.name;\n        if (type === 'radio' && name && isChecked) {\n            document\n                .querySelectorAll(\"input[type=\\\"radio\\\"][name=\\\"\" + name + \"\\\"]\")\n                .forEach(function (el) {\n                if (el !== target) {\n                    cbWithDedup(el, {\n                        text: el.value,\n                        isChecked: !isChecked\n                    });\n                }\n            });\n        }\n    }\n    function cbWithDedup(target, v) {\n        var lastInputValue = lastInputValueMap.get(target);\n        if (!lastInputValue ||\n            lastInputValue.text !== v.text ||\n            lastInputValue.isChecked !== v.isChecked) {\n            lastInputValueMap.set(target, v);\n            var id = mirror.getId(target);\n            cb(__assign({}, v, { id: id }));\n        }\n    }\n    var handlers = [\n        'input',\n        'change',\n    ].map(function (eventName) { return on(eventName, eventHandler); });\n    var propertyDescriptor = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, 'value');\n    if (propertyDescriptor && propertyDescriptor.set) {\n        handlers.push.apply(handlers, HOOK_PROPERTIES.map(function (p) {\n            return hookSetter(p[0], p[1], {\n                set: function () {\n                    eventHandler({ target: this });\n                }\n            });\n        }));\n    }\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initObservers(o) {\n    var mutationObserver = initMutationObserver(o.mutationCb);\n    var mousemoveHandler = initMousemoveObserver(o.mousemoveCb);\n    var mouseInteractionHandler = initMouseInteractionObserver(o.mouseInteractionCb);\n    var scrollHandler = initScrollObserver(o.scrollCb);\n    var viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb);\n    var inputHandler = initInputObserver(o.inputCb);\n    return function () {\n        mutationObserver.disconnect();\n        mousemoveHandler();\n        mouseInteractionHandler();\n        scrollHandler();\n        viewportResizeHandler();\n        inputHandler();\n    };\n}\n\nfunction wrapEvent(e) {\n    return __assign({}, e, { timestamp: Date.now() });\n}\nfunction record(options) {\n    if (options === void 0) { options = {}; }\n    var emit = options.emit, checkoutEveryNms = options.checkoutEveryNms, checkoutEveryNth = options.checkoutEveryNth;\n    if (!emit) {\n        throw new Error('emit function is required');\n    }\n    var lastFullSnapshotEvent;\n    var incrementalSnapshotCount = 0;\n    var wrappedEmit = function (e, isCheckout) {\n        emit(e, isCheckout);\n        if (e.type === EventType.FullSnapshot) {\n            lastFullSnapshotEvent = e;\n            incrementalSnapshotCount = 0;\n        }\n        else if (e.type === EventType.IncrementalSnapshot) {\n            incrementalSnapshotCount++;\n            var exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\n            var exceedTime = checkoutEveryNms &&\n                e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\n            if (exceedCount || exceedTime) {\n                takeFullSnapshot(true);\n            }\n        }\n    };\n    function takeFullSnapshot(isCheckout) {\n        if (isCheckout === void 0) { isCheckout = false; }\n        wrappedEmit(wrapEvent({\n            type: EventType.Meta,\n            data: {\n                href: window.location.href,\n                width: getWindowWidth(),\n                height: getWindowHeight()\n            }\n        }), isCheckout);\n        var _a = snapshot(document), node = _a[0], idNodeMap = _a[1];\n        if (!node) {\n            return console.warn('Failed to snapshot the document');\n        }\n        mirror.map = idNodeMap;\n        wrappedEmit(wrapEvent({\n            type: EventType.FullSnapshot,\n            data: {\n                node: node,\n                initialOffset: {\n                    left: document.documentElement.scrollLeft,\n                    top: document.documentElement.scrollTop\n                }\n            }\n        }));\n    }\n    try {\n        var handlers_1 = [];\n        handlers_1.push(on('DOMContentLoaded', function () {\n            wrappedEmit(wrapEvent({\n                type: EventType.DomContentLoaded,\n                data: {}\n            }));\n        }));\n        var init_1 = function () {\n            takeFullSnapshot();\n            handlers_1.push(initObservers({\n                mutationCb: function (m) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Mutation }, m)\n                    }));\n                },\n                mousemoveCb: function (positions) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: {\n                            source: IncrementalSource.MouseMove,\n                            positions: positions\n                        }\n                    }));\n                },\n                mouseInteractionCb: function (d) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.MouseInteraction }, d)\n                    }));\n                },\n                scrollCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Scroll }, p)\n                    }));\n                },\n                viewportResizeCb: function (d) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.ViewportResize }, d)\n                    }));\n                },\n                inputCb: function (v) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Input }, v)\n                    }));\n                }\n            }));\n        };\n        if (document.readyState === 'interactive' ||\n            document.readyState === 'complete') {\n            init_1();\n        }\n        else {\n            handlers_1.push(on('load', function () {\n                wrappedEmit(wrapEvent({\n                    type: EventType.Load,\n                    data: {}\n                }));\n                init_1();\n            }, window));\n        }\n        return function () {\n            handlers_1.forEach(function (h) { return h(); });\n        };\n    }\n    catch (error) {\n        console.warn(error);\n    }\n}\n\n//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n                                                               \n\n// An array of all currently registered event handlers for a type\n                                            \n                                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                 \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).slice().map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).slice().map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nvar mittProxy = /*#__PURE__*/Object.freeze({\n    default: mitt\n});\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar smoothscroll = createCommonjsModule(function (module, exports) {\n/* smoothscroll v0.4.0 - 2018 - Dustan Kasten, Jeremias Menichelli - MIT License */\n(function () {\n\n  // polyfill\n  function polyfill() {\n    // aliases\n    var w = window;\n    var d = document;\n\n    // return if scroll behavior is supported and polyfill is not forced\n    if (\n      'scrollBehavior' in d.documentElement.style &&\n      w.__forceSmoothScrollPolyfill__ !== true\n    ) {\n      return;\n    }\n\n    // globals\n    var Element = w.HTMLElement || w.Element;\n    var SCROLL_TIME = 468;\n\n    // object gathering original scroll methods\n    var original = {\n      scroll: w.scroll || w.scrollTo,\n      scrollBy: w.scrollBy,\n      elementScroll: Element.prototype.scroll || scrollElement,\n      scrollIntoView: Element.prototype.scrollIntoView\n    };\n\n    // define timing method\n    var now =\n      w.performance && w.performance.now\n        ? w.performance.now.bind(w.performance)\n        : Date.now;\n\n    /**\n     * indicates if a the current browser is made by Microsoft\n     * @method isMicrosoftBrowser\n     * @param {String} userAgent\n     * @returns {Boolean}\n     */\n    function isMicrosoftBrowser(userAgent) {\n      var userAgentPatterns = ['MSIE ', 'Trident/', 'Edge/'];\n\n      return new RegExp(userAgentPatterns.join('|')).test(userAgent);\n    }\n\n    /*\n     * IE has rounding bug rounding down clientHeight and clientWidth and\n     * rounding up scrollHeight and scrollWidth causing false positives\n     * on hasScrollableSpace\n     */\n    var ROUNDING_TOLERANCE = isMicrosoftBrowser(w.navigator.userAgent) ? 1 : 0;\n\n    /**\n     * changes scroll position inside an element\n     * @method scrollElement\n     * @param {Number} x\n     * @param {Number} y\n     * @returns {undefined}\n     */\n    function scrollElement(x, y) {\n      this.scrollLeft = x;\n      this.scrollTop = y;\n    }\n\n    /**\n     * returns result of applying ease math function to a number\n     * @method ease\n     * @param {Number} k\n     * @returns {Number}\n     */\n    function ease(k) {\n      return 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n\n    /**\n     * indicates if a smooth behavior should be applied\n     * @method shouldBailOut\n     * @param {Number|Object} firstArg\n     * @returns {Boolean}\n     */\n    function shouldBailOut(firstArg) {\n      if (\n        firstArg === null ||\n        typeof firstArg !== 'object' ||\n        firstArg.behavior === undefined ||\n        firstArg.behavior === 'auto' ||\n        firstArg.behavior === 'instant'\n      ) {\n        // first argument is not an object/null\n        // or behavior is auto, instant or undefined\n        return true;\n      }\n\n      if (typeof firstArg === 'object' && firstArg.behavior === 'smooth') {\n        // first argument is an object and behavior is smooth\n        return false;\n      }\n\n      // throw error when behavior is not supported\n      throw new TypeError(\n        'behavior member of ScrollOptions ' +\n          firstArg.behavior +\n          ' is not a valid value for enumeration ScrollBehavior.'\n      );\n    }\n\n    /**\n     * indicates if an element has scrollable space in the provided axis\n     * @method hasScrollableSpace\n     * @param {Node} el\n     * @param {String} axis\n     * @returns {Boolean}\n     */\n    function hasScrollableSpace(el, axis) {\n      if (axis === 'Y') {\n        return el.clientHeight + ROUNDING_TOLERANCE < el.scrollHeight;\n      }\n\n      if (axis === 'X') {\n        return el.clientWidth + ROUNDING_TOLERANCE < el.scrollWidth;\n      }\n    }\n\n    /**\n     * indicates if an element has a scrollable overflow property in the axis\n     * @method canOverflow\n     * @param {Node} el\n     * @param {String} axis\n     * @returns {Boolean}\n     */\n    function canOverflow(el, axis) {\n      var overflowValue = w.getComputedStyle(el, null)['overflow' + axis];\n\n      return overflowValue === 'auto' || overflowValue === 'scroll';\n    }\n\n    /**\n     * indicates if an element can be scrolled in either axis\n     * @method isScrollable\n     * @param {Node} el\n     * @param {String} axis\n     * @returns {Boolean}\n     */\n    function isScrollable(el) {\n      var isScrollableY = hasScrollableSpace(el, 'Y') && canOverflow(el, 'Y');\n      var isScrollableX = hasScrollableSpace(el, 'X') && canOverflow(el, 'X');\n\n      return isScrollableY || isScrollableX;\n    }\n\n    /**\n     * finds scrollable parent of an element\n     * @method findScrollableParent\n     * @param {Node} el\n     * @returns {Node} el\n     */\n    function findScrollableParent(el) {\n      var isBody;\n\n      do {\n        el = el.parentNode;\n\n        isBody = el === d.body;\n      } while (isBody === false && isScrollable(el) === false);\n\n      isBody = null;\n\n      return el;\n    }\n\n    /**\n     * self invoked function that, given a context, steps through scrolling\n     * @method step\n     * @param {Object} context\n     * @returns {undefined}\n     */\n    function step(context) {\n      var time = now();\n      var value;\n      var currentX;\n      var currentY;\n      var elapsed = (time - context.startTime) / SCROLL_TIME;\n\n      // avoid elapsed times higher than one\n      elapsed = elapsed > 1 ? 1 : elapsed;\n\n      // apply easing to elapsed time\n      value = ease(elapsed);\n\n      currentX = context.startX + (context.x - context.startX) * value;\n      currentY = context.startY + (context.y - context.startY) * value;\n\n      context.method.call(context.scrollable, currentX, currentY);\n\n      // scroll more if we have not reached our destination\n      if (currentX !== context.x || currentY !== context.y) {\n        w.requestAnimationFrame(step.bind(w, context));\n      }\n    }\n\n    /**\n     * scrolls window or element with a smooth behavior\n     * @method smoothScroll\n     * @param {Object|Node} el\n     * @param {Number} x\n     * @param {Number} y\n     * @returns {undefined}\n     */\n    function smoothScroll(el, x, y) {\n      var scrollable;\n      var startX;\n      var startY;\n      var method;\n      var startTime = now();\n\n      // define scroll context\n      if (el === d.body) {\n        scrollable = w;\n        startX = w.scrollX || w.pageXOffset;\n        startY = w.scrollY || w.pageYOffset;\n        method = original.scroll;\n      } else {\n        scrollable = el;\n        startX = el.scrollLeft;\n        startY = el.scrollTop;\n        method = scrollElement;\n      }\n\n      // scroll looping over a frame\n      step({\n        scrollable: scrollable,\n        method: method,\n        startTime: startTime,\n        startX: startX,\n        startY: startY,\n        x: x,\n        y: y\n      });\n    }\n\n    // ORIGINAL METHODS OVERRIDES\n    // w.scroll and w.scrollTo\n    w.scroll = w.scrollTo = function() {\n      // avoid action when no arguments are passed\n      if (arguments[0] === undefined) {\n        return;\n      }\n\n      // avoid smooth behavior if not required\n      if (shouldBailOut(arguments[0]) === true) {\n        original.scroll.call(\n          w,\n          arguments[0].left !== undefined\n            ? arguments[0].left\n            : typeof arguments[0] !== 'object'\n              ? arguments[0]\n              : w.scrollX || w.pageXOffset,\n          // use top prop, second argument if present or fallback to scrollY\n          arguments[0].top !== undefined\n            ? arguments[0].top\n            : arguments[1] !== undefined\n              ? arguments[1]\n              : w.scrollY || w.pageYOffset\n        );\n\n        return;\n      }\n\n      // LET THE SMOOTHNESS BEGIN!\n      smoothScroll.call(\n        w,\n        d.body,\n        arguments[0].left !== undefined\n          ? ~~arguments[0].left\n          : w.scrollX || w.pageXOffset,\n        arguments[0].top !== undefined\n          ? ~~arguments[0].top\n          : w.scrollY || w.pageYOffset\n      );\n    };\n\n    // w.scrollBy\n    w.scrollBy = function() {\n      // avoid action when no arguments are passed\n      if (arguments[0] === undefined) {\n        return;\n      }\n\n      // avoid smooth behavior if not required\n      if (shouldBailOut(arguments[0])) {\n        original.scrollBy.call(\n          w,\n          arguments[0].left !== undefined\n            ? arguments[0].left\n            : typeof arguments[0] !== 'object' ? arguments[0] : 0,\n          arguments[0].top !== undefined\n            ? arguments[0].top\n            : arguments[1] !== undefined ? arguments[1] : 0\n        );\n\n        return;\n      }\n\n      // LET THE SMOOTHNESS BEGIN!\n      smoothScroll.call(\n        w,\n        d.body,\n        ~~arguments[0].left + (w.scrollX || w.pageXOffset),\n        ~~arguments[0].top + (w.scrollY || w.pageYOffset)\n      );\n    };\n\n    // Element.prototype.scroll and Element.prototype.scrollTo\n    Element.prototype.scroll = Element.prototype.scrollTo = function() {\n      // avoid action when no arguments are passed\n      if (arguments[0] === undefined) {\n        return;\n      }\n\n      // avoid smooth behavior if not required\n      if (shouldBailOut(arguments[0]) === true) {\n        // if one number is passed, throw error to match Firefox implementation\n        if (typeof arguments[0] === 'number' && arguments[1] === undefined) {\n          throw new SyntaxError('Value could not be converted');\n        }\n\n        original.elementScroll.call(\n          this,\n          // use left prop, first number argument or fallback to scrollLeft\n          arguments[0].left !== undefined\n            ? ~~arguments[0].left\n            : typeof arguments[0] !== 'object' ? ~~arguments[0] : this.scrollLeft,\n          // use top prop, second argument or fallback to scrollTop\n          arguments[0].top !== undefined\n            ? ~~arguments[0].top\n            : arguments[1] !== undefined ? ~~arguments[1] : this.scrollTop\n        );\n\n        return;\n      }\n\n      var left = arguments[0].left;\n      var top = arguments[0].top;\n\n      // LET THE SMOOTHNESS BEGIN!\n      smoothScroll.call(\n        this,\n        this,\n        typeof left === 'undefined' ? this.scrollLeft : ~~left,\n        typeof top === 'undefined' ? this.scrollTop : ~~top\n      );\n    };\n\n    // Element.prototype.scrollBy\n    Element.prototype.scrollBy = function() {\n      // avoid action when no arguments are passed\n      if (arguments[0] === undefined) {\n        return;\n      }\n\n      // avoid smooth behavior if not required\n      if (shouldBailOut(arguments[0]) === true) {\n        original.elementScroll.call(\n          this,\n          arguments[0].left !== undefined\n            ? ~~arguments[0].left + this.scrollLeft\n            : ~~arguments[0] + this.scrollLeft,\n          arguments[0].top !== undefined\n            ? ~~arguments[0].top + this.scrollTop\n            : ~~arguments[1] + this.scrollTop\n        );\n\n        return;\n      }\n\n      this.scroll({\n        left: ~~arguments[0].left + this.scrollLeft,\n        top: ~~arguments[0].top + this.scrollTop,\n        behavior: arguments[0].behavior\n      });\n    };\n\n    // Element.prototype.scrollIntoView\n    Element.prototype.scrollIntoView = function() {\n      // avoid smooth behavior if not required\n      if (shouldBailOut(arguments[0]) === true) {\n        original.scrollIntoView.call(\n          this,\n          arguments[0] === undefined ? true : arguments[0]\n        );\n\n        return;\n      }\n\n      // LET THE SMOOTHNESS BEGIN!\n      var scrollableParent = findScrollableParent(this);\n      var parentRects = scrollableParent.getBoundingClientRect();\n      var clientRects = this.getBoundingClientRect();\n\n      if (scrollableParent !== d.body) {\n        // reveal element inside parent\n        smoothScroll.call(\n          this,\n          scrollableParent,\n          scrollableParent.scrollLeft + clientRects.left - parentRects.left,\n          scrollableParent.scrollTop + clientRects.top - parentRects.top\n        );\n\n        // reveal parent in viewport unless is fixed\n        if (w.getComputedStyle(scrollableParent).position !== 'fixed') {\n          w.scrollBy({\n            left: parentRects.left,\n            top: parentRects.top,\n            behavior: 'smooth'\n          });\n        }\n      } else {\n        // reveal element in viewport\n        w.scrollBy({\n          left: clientRects.left,\n          top: clientRects.top,\n          behavior: 'smooth'\n        });\n      }\n    };\n  }\n\n  {\n    // commonjs\n    module.exports = { polyfill: polyfill };\n  }\n\n}());\n});\nvar smoothscroll_1 = smoothscroll.polyfill;\n\nvar Timer = (function () {\n    function Timer(config, actions) {\n        if (actions === void 0) { actions = []; }\n        this.timeOffset = 0;\n        this.actions = actions;\n        this.config = config;\n    }\n    Timer.prototype.addAction = function (action) {\n        var index = this.findActionIndex(action);\n        this.actions.splice(index, 0, action);\n    };\n    Timer.prototype.addActions = function (actions) {\n        var _a;\n        (_a = this.actions).push.apply(_a, actions);\n    };\n    Timer.prototype.start = function () {\n        this.actions.sort(function (a1, a2) { return a1.delay - a2.delay; });\n        this.timeOffset = 0;\n        var lastTimestamp = performance.now();\n        var _a = this, actions = _a.actions, config = _a.config;\n        var self = this;\n        function check(time) {\n            self.timeOffset += (time - lastTimestamp) * config.speed;\n            lastTimestamp = time;\n            while (actions.length) {\n                var action = actions[0];\n                if (self.timeOffset >= action.delay) {\n                    actions.shift();\n                    action.doAction();\n                }\n                else {\n                    break;\n                }\n            }\n            if (actions.length > 0) {\n                self.raf = requestAnimationFrame(check);\n            }\n        }\n        this.raf = requestAnimationFrame(check);\n    };\n    Timer.prototype.clear = function () {\n        if (this.raf) {\n            cancelAnimationFrame(this.raf);\n        }\n        this.actions.length = 0;\n    };\n    Timer.prototype.findActionIndex = function (action) {\n        var start = 0;\n        var end = this.actions.length - 1;\n        while (start <= end) {\n            var mid = Math.floor((start + end) / 2);\n            if (this.actions[mid].delay < action.delay) {\n                start = mid + 1;\n            }\n            else if (this.actions[mid].delay > action.delay) {\n                end = mid - 1;\n            }\n            else {\n                return mid;\n            }\n        }\n        return start;\n    };\n    return Timer;\n}());\n\nvar rules = [\n    'iframe, .rr-block { background: #ccc }',\n    'noscript { display: none !important; }',\n];\n\nvar SKIP_TIME_THRESHOLD = 10 * 1000;\nvar SKIP_TIME_INTERVAL = 5 * 1000;\nsmoothscroll_1();\nvar mitt$1 = mitt || mittProxy;\nvar REPLAY_CONSOLE_PREFIX = '[replayer]';\nvar Replayer = (function () {\n    function Replayer(events, config) {\n        this.events = [];\n        this.emitter = mitt$1();\n        this.baselineTime = 0;\n        this.noramlSpeed = -1;\n        this.missingNodeRetryMap = {};\n        if (events.length < 2) {\n            throw new Error('Replayer need at least 2 events.');\n        }\n        this.events = events;\n        this.handleResize = this.handleResize.bind(this);\n        var defaultConfig = {\n            speed: 1,\n            root: document.body,\n            loadTimeout: 0,\n            skipInactive: false,\n            showWarning: true,\n            showDebug: false\n        };\n        this.config = Object.assign({}, defaultConfig, config);\n        this.timer = new Timer(this.config);\n        this.setupDom();\n        this.emitter.on('resize', this.handleResize);\n    }\n    Replayer.prototype.on = function (event, handler) {\n        this.emitter.on(event, handler);\n    };\n    Replayer.prototype.setConfig = function (config) {\n        var _this = this;\n        Object.keys(config).forEach(function (key) {\n            _this.config[key] = config[key];\n        });\n        if (!this.config.skipInactive) {\n            this.noramlSpeed = -1;\n        }\n    };\n    Replayer.prototype.getMetaData = function () {\n        var firstEvent = this.events[0];\n        var lastEvent = this.events[this.events.length - 1];\n        return {\n            totalTime: lastEvent.timestamp - firstEvent.timestamp\n        };\n    };\n    Replayer.prototype.getTimeOffset = function () {\n        return this.baselineTime - this.events[0].timestamp;\n    };\n    Replayer.prototype.play = function (timeOffset) {\n        if (timeOffset === void 0) { timeOffset = 0; }\n        this.timer.clear();\n        this.baselineTime = this.events[0].timestamp + timeOffset;\n        var actions = new Array();\n        for (var _i = 0, _a = this.events; _i < _a.length; _i++) {\n            var event = _a[_i];\n            var isSync = event.timestamp < this.baselineTime;\n            var castFn = this.getCastFn(event, isSync);\n            if (isSync) {\n                castFn();\n            }\n            else {\n                actions.push({ doAction: castFn, delay: this.getDelay(event) });\n            }\n        }\n        this.timer.addActions(actions);\n        this.timer.start();\n        this.emitter.emit(ReplayerEvents.Start);\n    };\n    Replayer.prototype.pause = function () {\n        this.timer.clear();\n        this.emitter.emit(ReplayerEvents.Pause);\n    };\n    Replayer.prototype.resume = function (timeOffset) {\n        if (timeOffset === void 0) { timeOffset = 0; }\n        this.timer.clear();\n        this.baselineTime = this.events[0].timestamp + timeOffset;\n        var actions = new Array();\n        for (var _i = 0, _a = this.events; _i < _a.length; _i++) {\n            var event = _a[_i];\n            if (event.timestamp <= this.lastPlayedEvent.timestamp ||\n                event === this.lastPlayedEvent) {\n                continue;\n            }\n            var castFn = this.getCastFn(event);\n            actions.push({\n                doAction: castFn,\n                delay: this.getDelay(event)\n            });\n        }\n        this.timer.addActions(actions);\n        this.timer.start();\n        this.emitter.emit(ReplayerEvents.Resume);\n    };\n    Replayer.prototype.setupDom = function () {\n        this.wrapper = document.createElement('div');\n        this.wrapper.classList.add('replayer-wrapper');\n        this.config.root.appendChild(this.wrapper);\n        this.mouse = document.createElement('div');\n        this.mouse.classList.add('replayer-mouse');\n        this.wrapper.appendChild(this.mouse);\n        this.iframe = document.createElement('iframe');\n        this.iframe.setAttribute('sandbox', 'allow-same-origin');\n        this.iframe.setAttribute('scrolling', 'no');\n        this.wrapper.appendChild(this.iframe);\n    };\n    Replayer.prototype.handleResize = function (dimension) {\n        this.iframe.width = dimension.width + \"px\";\n        this.iframe.height = dimension.height + \"px\";\n    };\n    Replayer.prototype.getDelay = function (event) {\n        if (event.type === EventType.IncrementalSnapshot &&\n            event.data.source === IncrementalSource.MouseMove) {\n            var firstOffset = event.data.positions[0].timeOffset;\n            var firstTimestamp = event.timestamp + firstOffset;\n            event.delay = firstTimestamp - this.baselineTime;\n            return firstTimestamp - this.baselineTime;\n        }\n        event.delay = event.timestamp - this.baselineTime;\n        return event.timestamp - this.baselineTime;\n    };\n    Replayer.prototype.getCastFn = function (event, isSync) {\n        var _this = this;\n        if (isSync === void 0) { isSync = false; }\n        var castFn;\n        switch (event.type) {\n            case EventType.DomContentLoaded:\n            case EventType.Load:\n                break;\n            case EventType.Meta:\n                castFn = function () {\n                    return _this.emitter.emit(ReplayerEvents.Resize, {\n                        width: event.data.width,\n                        height: event.data.height\n                    });\n                };\n                break;\n            case EventType.FullSnapshot:\n                castFn = function () {\n                    _this.rebuildFullSnapshot(event);\n                    _this.iframe.contentWindow.scrollTo(event.data.initialOffset);\n                };\n                break;\n            case EventType.IncrementalSnapshot:\n                castFn = function () {\n                    _this.applyIncremental(event, isSync);\n                    if (event === _this.nextUserInteractionEvent) {\n                        _this.nextUserInteractionEvent = null;\n                        _this.restoreSpeed();\n                    }\n                    if (_this.config.skipInactive && !_this.nextUserInteractionEvent) {\n                        for (var _i = 0, _a = _this.events; _i < _a.length; _i++) {\n                            var _event = _a[_i];\n                            if (_event.timestamp <= event.timestamp) {\n                                continue;\n                            }\n                            if (_this.isUserInteraction(_event)) {\n                                if (_event.delay - event.delay >\n                                    SKIP_TIME_THRESHOLD * _this.config.speed) {\n                                    _this.nextUserInteractionEvent = _event;\n                                }\n                                break;\n                            }\n                        }\n                        if (_this.nextUserInteractionEvent) {\n                            _this.noramlSpeed = _this.config.speed;\n                            var skipTime = _this.nextUserInteractionEvent.delay - event.delay;\n                            var payload = {\n                                speed: Math.min(Math.round(skipTime / SKIP_TIME_INTERVAL), 360)\n                            };\n                            _this.setConfig(payload);\n                            _this.emitter.emit(ReplayerEvents.SkipStart, payload);\n                        }\n                    }\n                };\n                break;\n            default:\n        }\n        var wrappedCastFn = function () {\n            if (castFn) {\n                castFn();\n            }\n            _this.lastPlayedEvent = event;\n            if (event === _this.events[_this.events.length - 1]) {\n                _this.restoreSpeed();\n                _this.emitter.emit(ReplayerEvents.Finish);\n            }\n        };\n        return wrappedCastFn;\n    };\n    Replayer.prototype.rebuildFullSnapshot = function (event) {\n        if (Object.keys(this.missingNodeRetryMap).length) {\n            console.warn('Found unresolved missing node map', this.missingNodeRetryMap);\n        }\n        this.missingNodeRetryMap = {};\n        mirror.map = rebuild(event.data.node, this.iframe.contentDocument)[1];\n        var styleEl = document.createElement('style');\n        var _a = this.iframe.contentDocument, documentElement = _a.documentElement, head = _a.head;\n        documentElement.insertBefore(styleEl, head);\n        for (var idx = 0; idx < rules.length; idx++) {\n            styleEl.sheet.insertRule(rules[idx], idx);\n        }\n        this.emitter.emit(ReplayerEvents.FullsnapshotRebuilded);\n        this.waitForStylesheetLoad();\n    };\n    Replayer.prototype.waitForStylesheetLoad = function () {\n        var _this = this;\n        var head = this.iframe.contentDocument.head;\n        if (head) {\n            var unloadSheets_1 = new Set();\n            var timer_1;\n            head\n                .querySelectorAll('link[rel=\"stylesheet\"]')\n                .forEach(function (css) {\n                if (!css.sheet) {\n                    if (unloadSheets_1.size === 0) {\n                        _this.pause();\n                        _this.emitter.emit(ReplayerEvents.LoadStylesheetStart);\n                        timer_1 = window.setTimeout(function () {\n                            _this.resume();\n                            timer_1 = -1;\n                        }, _this.config.loadTimeout);\n                    }\n                    unloadSheets_1.add(css);\n                    css.addEventListener('load', function () {\n                        unloadSheets_1[\"delete\"](css);\n                        if (unloadSheets_1.size === 0 && timer_1 !== -1) {\n                            _this.resume();\n                            _this.emitter.emit(ReplayerEvents.LoadStylesheetEnd);\n                            if (timer_1) {\n                                window.clearTimeout(timer_1);\n                            }\n                        }\n                    });\n                }\n            });\n        }\n    };\n    Replayer.prototype.applyIncremental = function (e, isSync) {\n        var _this = this;\n        var d = e.data;\n        switch (d.source) {\n            case IncrementalSource.Mutation: {\n                d.removes.forEach(function (mutation) {\n                    var target = mirror.getNode(mutation.id);\n                    if (!target) {\n                        return _this.warnNodeNotFound(d, mutation.id);\n                    }\n                    var parent = mirror.getNode(mutation.parentId);\n                    if (!parent) {\n                        return _this.warnNodeNotFound(d, mutation.parentId);\n                    }\n                    mirror.removeNodeFromMap(target);\n                    if (parent) {\n                        parent.removeChild(target);\n                    }\n                });\n                var missingNodeMap_1 = __assign({}, this.missingNodeRetryMap);\n                d.adds.forEach(function (mutation) {\n                    var target = buildNodeWithSN(mutation.node, _this.iframe.contentDocument, mirror.map, true);\n                    var parent = mirror.getNode(mutation.parentId);\n                    if (!parent) {\n                        return _this.warnNodeNotFound(d, mutation.parentId);\n                    }\n                    var previous = null;\n                    var next = null;\n                    if (mutation.previousId) {\n                        previous = mirror.getNode(mutation.previousId);\n                    }\n                    if (mutation.nextId) {\n                        next = mirror.getNode(mutation.nextId);\n                    }\n                    if (mutation.previousId === -1 || mutation.nextId === -1) {\n                        missingNodeMap_1[mutation.node.id] = {\n                            node: target,\n                            mutation: mutation\n                        };\n                        return;\n                    }\n                    if (previous &&\n                        previous.nextSibling &&\n                        previous.nextSibling.parentNode) {\n                        parent.insertBefore(target, previous.nextSibling);\n                    }\n                    else if (next && next.parentNode) {\n                        parent.insertBefore(target, next);\n                    }\n                    else {\n                        parent.appendChild(target);\n                    }\n                    if (mutation.previousId || mutation.nextId) {\n                        _this.resolveMissingNode(missingNodeMap_1, parent, target, mutation);\n                    }\n                });\n                if (Object.keys(missingNodeMap_1).length) {\n                    Object.assign(this.missingNodeRetryMap, missingNodeMap_1);\n                }\n                d.texts.forEach(function (mutation) {\n                    var target = mirror.getNode(mutation.id);\n                    if (!target) {\n                        return _this.warnNodeNotFound(d, mutation.id);\n                    }\n                    target.textContent = mutation.value;\n                });\n                d.attributes.forEach(function (mutation) {\n                    var target = mirror.getNode(mutation.id);\n                    if (!target) {\n                        return _this.warnNodeNotFound(d, mutation.id);\n                    }\n                    for (var attributeName in mutation.attributes) {\n                        if (typeof attributeName === 'string') {\n                            var value = mutation.attributes[attributeName];\n                            if (value) {\n                                target.setAttribute(attributeName, value);\n                            }\n                            else {\n                                target.removeAttribute(attributeName);\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n            case IncrementalSource.MouseMove:\n                if (!isSync) {\n                    d.positions.forEach(function (p) {\n                        var action = {\n                            doAction: function () {\n                                _this.moveAndHover(d, p.x, p.y, p.id);\n                            },\n                            delay: p.timeOffset + e.timestamp - _this.baselineTime\n                        };\n                        _this.timer.addAction(action);\n                    });\n                }\n                break;\n            case IncrementalSource.MouseInteraction: {\n                if (d.id === -1) {\n                    break;\n                }\n                var event = new Event(MouseInteractions[d.type].toLowerCase());\n                var target = mirror.getNode(d.id);\n                if (!target) {\n                    return this.debugNodeNotFound(d, d.id);\n                }\n                switch (d.type) {\n                    case MouseInteractions.Blur:\n                        if (target.blur) {\n                            target.blur();\n                        }\n                        break;\n                    case MouseInteractions.Focus:\n                        if (target.focus) {\n                            target.focus({\n                                preventScroll: true\n                            });\n                        }\n                        break;\n                    case MouseInteractions.Click:\n                        if (!isSync) {\n                            this.moveAndHover(d, d.x, d.y, d.id);\n                            this.mouse.classList.remove('active');\n                            void this.mouse.offsetWidth;\n                            this.mouse.classList.add('active');\n                        }\n                        break;\n                    default:\n                        target.dispatchEvent(event);\n                }\n                break;\n            }\n            case IncrementalSource.Scroll: {\n                if (d.id === -1) {\n                    break;\n                }\n                var target = mirror.getNode(d.id);\n                if (!target) {\n                    return this.debugNodeNotFound(d, d.id);\n                }\n                if (target === this.iframe.contentDocument) {\n                    this.iframe.contentWindow.scrollTo({\n                        top: d.y,\n                        left: d.x,\n                        behavior: isSync ? 'auto' : 'smooth'\n                    });\n                }\n                else {\n                    try {\n                        target.scrollTop = d.y;\n                        target.scrollLeft = d.x;\n                    }\n                    catch (error) {\n                    }\n                }\n                break;\n            }\n            case IncrementalSource.ViewportResize:\n                this.emitter.emit(ReplayerEvents.Resize, {\n                    width: d.width,\n                    height: d.height\n                });\n                break;\n            case IncrementalSource.Input: {\n                if (d.id === -1) {\n                    break;\n                }\n                var target = mirror.getNode(d.id);\n                if (!target) {\n                    return this.debugNodeNotFound(d, d.id);\n                }\n                try {\n                    target.checked = d.isChecked;\n                    target.value = d.text;\n                }\n                catch (error) {\n                }\n                break;\n            }\n            default:\n        }\n    };\n    Replayer.prototype.resolveMissingNode = function (map, parent, target, targetMutation) {\n        var previousId = targetMutation.previousId, nextId = targetMutation.nextId;\n        var previousInMap = previousId && map[previousId];\n        var nextInMap = nextId && map[nextId];\n        if (previousInMap) {\n            var _a = previousInMap, node = _a.node, mutation = _a.mutation;\n            parent.insertBefore(node, target);\n            delete map[mutation.node.id];\n            delete this.missingNodeRetryMap[mutation.node.id];\n            if (mutation.previousId || mutation.nextId) {\n                this.resolveMissingNode(map, parent, node, mutation);\n            }\n        }\n        if (nextInMap) {\n            var _b = nextInMap, node = _b.node, mutation = _b.mutation;\n            parent.insertBefore(node, target.nextSibling);\n            delete map[mutation.node.id];\n            delete this.missingNodeRetryMap[mutation.node.id];\n            if (mutation.previousId || mutation.nextId) {\n                this.resolveMissingNode(map, parent, node, mutation);\n            }\n        }\n    };\n    Replayer.prototype.moveAndHover = function (d, x, y, id) {\n        this.mouse.style.left = x + \"px\";\n        this.mouse.style.top = y + \"px\";\n        var target = mirror.getNode(id);\n        if (!target) {\n            return this.debugNodeNotFound(d, id);\n        }\n        this.hoverElements(target);\n    };\n    Replayer.prototype.hoverElements = function (el) {\n        this.iframe\n            .contentDocument.querySelectorAll('.\\\\:hover')\n            .forEach(function (hoveredEl) {\n            hoveredEl.classList.remove(':hover');\n        });\n        var currentEl = el;\n        while (currentEl) {\n            currentEl.classList.add(':hover');\n            currentEl = currentEl.parentElement;\n        }\n    };\n    Replayer.prototype.isUserInteraction = function (event) {\n        if (event.type !== EventType.IncrementalSnapshot) {\n            return false;\n        }\n        return (event.data.source > IncrementalSource.Mutation &&\n            event.data.source <= IncrementalSource.Input);\n    };\n    Replayer.prototype.restoreSpeed = function () {\n        if (this.noramlSpeed === -1) {\n            return;\n        }\n        var payload = { speed: this.noramlSpeed };\n        this.setConfig(payload);\n        this.emitter.emit(ReplayerEvents.SkipEnd, payload);\n        this.noramlSpeed = -1;\n    };\n    Replayer.prototype.warnNodeNotFound = function (d, id) {\n        if (!this.config.showWarning) {\n            return;\n        }\n        console.warn(REPLAY_CONSOLE_PREFIX, \"Node with id '\" + id + \"' not found in\", d);\n    };\n    Replayer.prototype.debugNodeNotFound = function (d, id) {\n        if (!this.config.showDebug) {\n            return;\n        }\n        console.log(REPLAY_CONSOLE_PREFIX, \"Node with id '\" + id + \"' not found in\", d);\n    };\n    return Replayer;\n}());\n\nexport { record, Replayer, mirror };\n","import { Logger } from './Logger'\nimport { Replayer, mirror, record } from 'rrweb'\n\nimport { TimestampProvider } from './TimestampProvider'\nimport { Disposable } from './Disposable'\n\n// ref. https://github.com/rrweb-io/rrweb/blob/master/guide.md\n\nexport class RRWebRecorderRecording {\n  constructor(\n    public tsStart: number,\n    public tsEnd: number,\n    public events: any[]\n  ) { }\n}\n\n\nexport class RRWebRecorder extends Disposable {\n  logger = new Logger(`RRWebRecorder`)\n  private events: Array<any> = []\n  private stopFunction: any = null\n  private timeStampProvider = new TimestampProvider()\n  private tsStart: number = this.timeStampProvider.ts()\n  private tsEnd: number = this.timeStampProvider.ts()\n\n  constructor() {\n    super()\n    // console.log(Replayer, mirror, record)\n  }\n\n  start = () => {\n    this.logger.debug(\"start\")\n    this.tsStart = this.timeStampProvider.ts()\n    this.events = []\n    this.stopFunction = record({\n      emit: (event: any) => {\n        this.events.push(event)\n      }\n    })\n  }\n\n  stop = (): RRWebRecorderRecording => {\n    this.logger.debug(\"stop\")\n    this.tsEnd = this.timeStampProvider.ts()\n    if (this.stopFunction) {\n      this.stopFunction()\n    }\n    return new RRWebRecorderRecording(this.tsStart, this.tsEnd, this.events)\n  }\n\n}","import { StreamRecorderRecording } from './StreamRecorder'\nimport { Configuration } from './Configuration'\nimport { Util } from \"./Util\"\nimport { Disposable } from \"./Disposable\"\nimport { StreamSegmenter } from \"./StreamSegmenter\"\nimport { Logger } from \"./Logger\"\nimport { RRWebRecorder } from './RRWebRecorder'\nimport { TimestampProvider } from './TimestampProvider'\nimport { async } from 'q';\n\n\nclass UrlProvider {\n  constructor(private conf: Configuration) {}\n  webcamRecordingUploadUrl = (): string => {\n    return Util.urlJoin(\n      this.conf.apiUrl || \"https://server-example-ozyxqwhick.now.sh/upload\",\n      this.conf.sessionId,\n      \"camera\"\n    )\n  }\n  rrWebRecordingUploadUrl = (): string => {\n    return Util.urlJoin(\n    this.conf.apiUrl || \"https://server-example-ozyxqwhick.now.sh/upload\",\n      this.conf.sessionId,\n      \"rrweb\"\n    )\n  }\n}\n\n\nclass Session {\n  constructor(\n    public conf: Configuration,\n    public mediaStream: MediaStream, // the webcam\n    public mediaStreamSegmenter: StreamSegmenter,\n    public rrWebRecorder: RRWebRecorder,\n    public urlProvider: UrlProvider = new UrlProvider(conf)\n  ) { }\n}\n\n\nexport class WebRecorderWorkflow1 {\n  logger = new Logger('WebRecorderWorkflow1')\n  timestampProvider = new TimestampProvider()\n\n  session: Session | undefined // session is valid within start() and stop()\n\n  previewMediaStream: MediaStream | undefined // reuse preview stream\n\n  uploads: Promise<void>[] = []\n\n  startPreview = async (configuration: Configuration) => {\n    const mediaStream = this.previewMediaStream || await Util.streamWebcamGet()\n    Util.streamAttachToVideoElement(mediaStream, configuration.video)\n    return mediaStream\n  }\n\n  stopPreview = async (configuration: Configuration) => {\n    configuration.video.pause()\n    configuration.video.srcObject = null\n  }\n\n  start = async (configuration: Configuration) => {\n    if (this.session != undefined) {\n      this.logger.debug(\"session is already in progress, stopping it\")\n      await this.stop()\n    }\n\n    this.logger.debug(\"session start, creating webcam stream\")\n    const mediaStream = this.previewMediaStream || await Util.streamWebcamGet()\n\n    const mediaStreamSegmenter = new StreamSegmenter(\n      mediaStream,\n      configuration.videoSegmentDurationMs,\n      (recording) => {\n        if (this.session == undefined) {\n          this.logger.debug(\"ERROR: SEGMENT WITH NO SESSION\")\n          return\n        }\n        const { blob, tsStart, tsEnd } = recording\n        const session = this.session\n        const ts = this.timestampProvider.ts()\n        this.logger.debug(`uploading camera blob type: ${blob.type}, size: ${blob.size}`)\n        this.uploads.push(\n          Util.blobUpload(blob, tsStart, tsEnd, session.urlProvider.webcamRecordingUploadUrl())\n        )\n      }\n    )\n\n    const rrweb = new RRWebRecorder()\n\n    this.session = new Session(configuration, mediaStream, mediaStreamSegmenter, rrweb)\n\n    this.session.mediaStreamSegmenter.start()\n    this.session.rrWebRecorder.start()\n    return await true\n  }\n\n  stop = async () => {\n    await 1\n    if (this.session == undefined) {\n      this.logger.debug(\"there is no session to stop\")\n      return\n    }\n    const session = this.session\n    const { mediaStream, mediaStreamSegmenter, rrWebRecorder} = session\n\n    await mediaStreamSegmenter.stop()\n\n    const rrWebRecorderRecording = rrWebRecorder.stop()\n    this.logger.debug(`uploading rrWeb events`)\n    const promises = this.uploads\n    this.uploads = []\n\n    promises.push(\n      Util.rrWebEventsUpload(\n        rrWebRecorderRecording.events,\n        rrWebRecorderRecording.tsStart,\n        rrWebRecorderRecording.tsEnd,\n        session.urlProvider.rrWebRecordingUploadUrl()\n      )\n    )\n    // TODO: upload rrEvents\n    // Util.rrWebEventsUpload(blob, ts)\n    mediaStream.getTracks().forEach(track => track.stop())\n    this.session = undefined\n    this.previewMediaStream = undefined\n    this.logger.debug('session stopped')\n    return Promise.all(promises)\n  }\n}\n","import { RRWebRecorder } from './RRWebRecorder'\nimport { WebRecorderWorkflow0 } from \"./WebRecorderWorkflow0\"\nimport { WebRecorderWorkflow1 } from \"./WebRecorderWorkflow1\"\n\nwindow.WebRecorderWorkflow0 = WebRecorderWorkflow0\nwindow.WebRecorderWorkflow1 = WebRecorderWorkflow1\n\nexport default {\n  WebRecorderWorkflow0: WebRecorderWorkflow0,\n  WebRecorderWorkflow1: WebRecorderWorkflow1,\n  workflow0: new WebRecorderWorkflow0().start,\n  workflow1: new WebRecorderWorkflow1().start\n}\n"]}